# LoveXAI è§’è‰²æ‰¹é‡ç”Ÿäº§æµæ°´çº¿æŒ‡å—

**ç‰ˆæœ¬**: 1.0
**æ—¥æœŸ**: 2025-12-10
**ç›®æ ‡**: å»ºç«‹ä¸€å¥—æ ‡å‡†åŒ–çš„æµæ°´çº¿ï¼Œç”¨äºæ‰¹é‡è®¾è®¡ã€ç”Ÿæˆå’Œå¯¼å…¥ 1300+ ä¸ªé«˜è´¨é‡ AI è§’è‰²ã€‚

---

## ğŸ”„ ç”Ÿäº§æµç¨‹æ¦‚è§ˆ

1.  **Phase 1: åˆ†ç±»ä½“ç³»è®¾è®¡ (Taxonomy)** - å®šä¹‰è§’è‰²çš„ç»´åº¦ã€ä¸»é¢˜å’Œæ¨¡ç‰ˆã€‚
2.  **Phase 2: æ•°æ®ç»“æ„å®šä¹‰ (Schema)** - ç¡®ç«‹æ ‡å‡†åŒ–çš„ JSON æ•°æ®æ ¼å¼ã€‚
3.  **Phase 3: AI ç”Ÿæˆæ¨¡ç‰ˆ (Prompting)** - ä½¿ç”¨ LLM æ‰¹é‡ç”Ÿæˆè§’è‰²å…ƒæ•°æ®ã€‚
4.  **Phase 4: æ‰¹é‡å¯¼å…¥å®ç° (Import)** - æ•°æ®åº“å¯¼å…¥ä¸æ›´æ–°è„šæœ¬ã€‚

---

## ğŸ“‹ Phase 1: è§’è‰²åˆ†ç±»ä½“ç³» (Taxonomy)

ä¸ºäº†ç¡®ä¿è§’è‰²çš„å¤šæ ·æ€§å’Œè¦†ç›–é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹ç»´åº¦è¿›è¡Œç»„åˆç”Ÿæˆã€‚

### 1.1 æ ¸å¿ƒåˆ†ç±» (Categories)

| åˆ†ç±» | ç›®æ ‡æ•°é‡ | å æ¯” | é‡ç‚¹ |
| :--- | :--- | :--- | :--- |
| **ğŸ‘© Female** | 500 | 38.5% | å¤šæ ·åŒ–èŒä¸šã€æ€§æ ¼ã€æ‹çˆ±å…³ç³» |
| **ğŸ‘¨ Male** | 500 | 38.5% | ç†æƒ³ç”·å‹ã€éœ¸é“æ€»è£ã€æš–ç”· |
| **ğŸŒ Anime** | 300 | 23.0% | äºŒæ¬¡å…ƒç”»é£ã€ç‰¹å®šèŒå±æ€§ã€å¹»æƒ³è®¾å®š |

### 1.2 ä¸»é¢˜ç»†åˆ† (Themes)

#### ğŸ‘© å¥³æ€§è§’è‰²ä¸»é¢˜æ± 
*   **æ—¥å¸¸ç³»**: Neighbor (é‚»å±…), Childhood Friend (é’æ¢…ç«¹é©¬), College Roommate (å®¤å‹), Barista (å’–å•¡å¸ˆ)
*   **èŒä¸šç³»**: Nurse (æŠ¤å£«), Teacher (è€å¸ˆ), Flight Attendant (ç©ºå§), CEO (å¥³æ€»è£), Doctor (åŒ»ç”Ÿ), Secretary (ç§˜ä¹¦)
*   **ç‰¹æ®Šå…³ç³»**: Stepsister (ç»§å¦¹), Ex-Girlfriend (å‰å¥³å‹), Secret Admirer (æš—æ‹è€…)
*   **å¹»æƒ³/äºšæ–‡åŒ–**: Vampire (å¸è¡€é¬¼), Witch (å¥³å·«), Elf (ç²¾çµ), Cyberpunk (èµ›åšæœ‹å…‹), Maid (å¥³ä»†), Goth (å“¥ç‰¹)

#### ğŸ‘¨ ç”·æ€§è§’è‰²ä¸»é¢˜æ± 
*   **æ—¥å¸¸ç³»**: Senior (å­¦é•¿), Neighbor (é‚»å±…å“¥å“¥), Tutor (å®¶æ•™), Colleague (åŒäº‹)
*   **ç†æƒ³å‹**: CEO (éœ¸é“æ€»è£), Doctor (åŒ»ç”Ÿ), Pilot (é£è¡Œå‘˜), Lawyer (å¾‹å¸ˆ), Firefighter (æ¶ˆé˜²å‘˜)
*   **ç‰¹æ®Š/å¹»æƒ³**: Prince (ç‹å­), Vampire Duke (å¸è¡€é¬¼å…¬çˆµ), Werewolf (ç‹¼äºº), Mafia Boss (é»‘é“å¤§ä½¬)

#### ğŸŒ åŠ¨æ¼«è§’è‰²ä¸»é¢˜æ± 
*   **èŒå±æ€§**: Tsundere (å‚²å¨‡), Yandere (ç—…å¨‡), Kuudere (ä¸‰æ— ), Onee-san (å¾¡å§)
*   **è®¾å®š**: Isekai Heroine (å¼‚ä¸–ç•Œå¥³ä¸»), Magical Girl (é­”æ³•å°‘å¥³), Idol (å¶åƒ), Fox Spirit (ç‹å¦–), Mecha Pilot (æœºç”²é©¾é©¶å‘˜)

### 1.3 æ€§æ ¼ç»´åº¦ (Personality Axes)

æ¯ä¸ªè§’è‰²åº”ä»ä»¥ä¸‹ä¸‰ä¸ªç»´åº¦ä¸­å„é€‰ä¸€ä¸ªæ ‡ç­¾è¿›è¡Œç»„åˆï¼š

1.  **æ ¸å¿ƒç‰¹è´¨ (Primary)**: Sweet (ç”œç¾), Mysterious (ç¥ç§˜), Dominant (å¼ºåŠ¿), Shy (å®³ç¾), Energetic (å…ƒæ°”), Cold (é«˜å†·)
2.  **æƒ…æ„Ÿæ¨¡å¼ (Emotional)**: Caring (ä½“è´´), Teasing (çˆ±æ‰å¼„), Possessive (å æœ‰æ¬²), Supportive (æ”¯æŒ), Tsundere (å˜´ç¡¬å¿ƒè½¯)
3.  **è¯´è¯é£æ ¼ (Speaking)**: Formal (æ­£å¼), Casual (éšæ„/ä¿šè¯­), Flirty (æ’©äºº), Poetic (è¯—æ„), Rude/Sharp (æ¯’èˆŒ)

### 1.4 å‰§æƒ…åœºæ™¯æ¨¡ç‰ˆ (Scenario Templates)

*   **T1 - æ„å¤–é‡é€¢**: "å¤šå¹´æœªè§ï¼Œåœ¨{location}å¶é‡..."
*   **T2 - æ·±å¤œåŠ ç­**: "åŠå…¬å®¤åªå‰©ä¸‹ä½ ä»¬ä¸¤äººï¼Œå¥¹èµ°è¿‡æ¥..."
*   **T3 - å—ä¼¤ç…§é¡¾**: "ä½ å—ä¼¤/ç”Ÿç—…äº†ï¼Œå¥¹ç„¦æ€¥åœ°..."
*   **T4 - ç§˜å¯†å…³ç³»**: "ä½œä¸º{role}ï¼Œè¿™æ®µå…³ç³»ä¸èƒ½å…¬å¼€..."
*   **T5 - å¼‚ä¸–ç•Œå¬å”¤**: "ä½ çªç„¶é†’æ¥ï¼Œé¢å‰ç«™ç€ä¸€ä½..."
*   **T6 - é†‰é…’è¯¯äº‹**: "æ´¾å¯¹ç»“æŸåï¼Œå¥¹å€Ÿç€é…’æ„..."

---

## ğŸ“ Phase 2: æ•°æ®ç»“æ„å®šä¹‰ (JSON Schema)

æ‰€æœ‰ç”Ÿæˆçš„æ•°æ®å¿…é¡»ä¸¥æ ¼ç¬¦åˆä»¥ä¸‹ TypeScript æ¥å£å®šä¹‰ã€‚

```typescript
interface CharacterData {
  // --- åŸºç¡€æ ‡è¯† ---
  name: string;               // è‹±æ–‡å
  username: string;           // å”¯ä¸€æ ‡è¯† (ä¾‹å¦‚: emma_nurse_001) -ç”¨äºå»é‡å’ŒURL
  
  // --- åˆ†ç±»æ ‡ç­¾ ---
  category: "female" | "male" | "anime";
  theme: string;              // ç»†åˆ†ä¸»é¢˜
  access_level: "free" | "plus" | "pro" | "ultimate";
  
  // --- æ ¸å¿ƒè®¾å®š ---
  description: string;        // çŸ­æè¿° (Card ä¸Šæ˜¾ç¤º)
  personality: string;        // è¯¦ç»†æ€§æ ¼æè¿° (100-200å­—ï¼ŒæŒ‡å¯¼ AI æ‰®æ¼”)
  traits: string[];           // [Tag1, Tag2, Tag3, Tag4] (å‰ç«¯æ˜¾ç¤ºæ ‡ç­¾)
  
  // --- æ²‰æµ¸å¼å‰§æƒ…å­—æ®µ ---
  scenario: string;           // å‰§æƒ…èƒŒæ™¯/å¼€åœºæƒ…å¢ƒæè¿°
  current_state: string;      // è§’è‰²å½“å‰çš„çŠ¶æ€/åŠ¨ä½œ/ç©¿ç€
  motivation: string;         // è§’è‰²åœ¨è¿™åœºå¯¹è¯ä¸­çš„æ ¸å¿ƒåŠ¨æœº/ç›®çš„
  background: string;         // è§’è‰²çš„èº«ä¸–/èƒŒæ™¯æ•…äº‹
  
  // --- å¯¹è¯é…ç½® ---
  greeting_message: string;   // ç¬¬ä¸€å¥å¼€åœºç™½ (éœ€åŒ…å«åŠ¨ä½œæå†™ *action*)
  suggestions: string[];      // 4ä¸ªç”¨æˆ·å›å¤å»ºè®®
  speaking_style: string;     // AI å›å¤é£æ ¼æŒ‡å— (æŒ‡å¯¼ System Prompt)
  
  // --- å›¾åƒç”Ÿæˆé…ç½® ---
  image_prompt: string;       // ç”¨äºç”Ÿæˆè§’è‰²ç«‹ç»˜çš„è¯¦ç»† Prompt
  appearance: {               // å¤–è²Œç‰¹å¾åˆ†è§£ (ç”¨äºä¸€è‡´æ€§/å‚è€ƒ)
    age: number;
    visual_style: string;     // e.g. "Realistic photo", "Anime style"
    clothing: string;
    features: string;
  };
  
  // --- ç³»ç»Ÿé…ç½® ---
  credits_per_message: number; // costs: Free=1, Plus=2, Pro/Ult=3+
  sort_order: number;          // æ’åºæƒé‡
}
```

---

## ğŸ¤– Phase 3: AI æ‰¹é‡ç”Ÿæˆæ¨¡ç‰ˆ (System Prompt)

å°†ä»¥ä¸‹ Prompt è¾“å…¥ç»™ GPT-4 æˆ– Claudeï¼Œç”¨äºæ‰¹é‡ç”Ÿæˆ JSON æ•°æ®ã€‚

### System Prompt

```markdown
Role: You are a Lead Character Designer for a premium AI companion platform.
Task: Create unique, high-quality character profiles based on the provided parameters.

Output Format: A single JSON object (or an array of objects) strictly following the schema below. No markdown formatting, just raw JSON.

Schema:
{
  "name": "string (Western name)",
  "username": "string (lowercase, unique, e.g., name_theme_id)",
  "category": "female" | "male" | "anime",
  "theme": "string",
  "access_level": "free" | "plus" | "pro" | "ultimate",
  "description": "string (1 very catchy sentence, max 60 chars)",
  "personality": "string (Detailed psychological profile, 3-4 sentences)",
  "traits": ["string (Adj 1)", "string (Adj 2)", "string (Adj 3)", "string (Adj 4)"],
  "scenario": "string (The specific situation where the chat begins, 2-3 sentences)",
  "current_state": "string (Visual description of current action/clothing, bullet points style)",
  "motivation": "string (What the character wants from the user right now)",
  "background": "string (Brief bio/history, 3-4 sentences)",
  "greeting_message": "string (Engaging first message, usually includes *action* or *feeling*)",
  "suggestions": ["string (User reply option 1)", "string ...2", "string ...3", "string ...4"],
  "speaking_style": "string (Instructions for AI: tone, quirks, formatting rules)",
  "image_prompt": "string (Highly detailed Stable Diffusion/Flux prompt, start with 'raw photo' or 'anime masterpiece', describe subject, pose, clothing, lighting, background)",
  "appearance": {
    "age": number,
    "visual_style": "string",
    "clothing": "string",
    "features": "string"
  },
  "credits_per_message": number,
  "sort_order": number
}

Design Guidelines:
1. **Premium Quality**: Avoid clichÃ©s text. Make characters feel deep and real.
2. **Hook**: The greeting and scenario must immediately hook the user to reply.
3. **Consistency**: The image prompt must match the description perfectly.
4. **Variety**: If correcting multiple characters, ensure they are distinct.
```

### User Input Example (Batch Generation)

```text
Please generate 5 "Female" characters using the "Nurse" theme.
Mix access levels: 2 Free, 2 Plus, 1 Pro.
Vary personalities: 1 Shy, 1 Strict, 1 Flirty, 1 Caring, 1 Burned-out.
Start sort_order from 100.
```

---

## âš™ï¸ Phase 4: æ‰¹é‡å¯¼å…¥è„šæœ¬ (Convex Implementation)

æˆ‘ä»¬å°†åœ¨ `convex/batch.ts` ä¸­å®ç°æ­¤è„šæœ¬ï¼Œæ”¯æŒå¹‚ç­‰æ“ä½œï¼ˆå³é‡å¤è¿è¡Œä¼šæ›´æ–°è€Œéé‡å¤åˆ›å»ºï¼‰ã€‚

### 4.1 æ ¸å¿ƒå¯¼å…¥å‡½æ•° (`batch.ts`)

```typescript
import { internalMutation } from "./_generated/server";
import { v } from "convex/values";

export const importCharacters = internalMutation({
  args: {
    characters: v.array(v.object({
      name: v.string(),
      username: v.string(),
      description: v.string(),
      personality: v.string(),
      traits: v.array(v.string()), // æ³¨æ„ï¼šSchemaä¸­æ˜¯JSONå­—ç¬¦ä¸²ï¼Œè¿™é‡Œä¼ å…¥æ•°ç»„ï¼Œå†…éƒ¨è½¬æ¢
      avatar_url: v.string(),      // å›¾ç‰‡ç”Ÿæˆåå¡«å…¥
      greeting_message: v.string(),
      suggestions: v.array(v.string()), // åŒä¸Šï¼Œå†…éƒ¨è½¬æ¢
      background: v.string(),
      scenario: v.string(),
      current_state: v.string(),
      motivation: v.string(),
      access_level: v.string(),
      sort_order: v.number(),
      credits_per_message: v.number(),
    })),
  },
  handler: async (ctx, args) => {
    let stats = { created: 0, updated: 0 };

    for (const char of args.characters) {
      // 1. Check existence by username
      const existing = await ctx.db
        .query("characters")
        .filter((q) => q.eq(q.field("username"), char.username))
        .first();

      // 2. Prepare search text
      const search_text = `${char.name} ${char.description} ${char.personality} ${char.theme}`;
      
      // 3. Prepare DB object (convert arrays to JSON strings as per current schema)
      const dbObj = {
        ...char,
        traits: JSON.stringify(char.traits),
        suggestions: JSON.stringify(char.suggestions),
        search_text,
        is_active: true,
        is_premium: char.access_level !== "free",
        chat_count: "0 chats", // Default
      };

      if (existing) {
        await ctx.db.patch(existing._id, dbObj);
        stats.updated++;
      } else {
        await ctx.db.insert("characters", dbObj as any);
        stats.created++;
      }
    }
    
    return stats;
  },
});
```

### 4.2 æ‰§è¡Œç­–ç•¥

1.  **JSON ç”Ÿæˆ**: ä½¿ç”¨ LLM ç”Ÿæˆ JSON æ–‡ä»¶ï¼ˆå¦‚ `batch_1_nurses.json`ï¼‰ã€‚
2.  **å›¾ç‰‡ç”Ÿæˆ**: ç¼–å†™ Python/Node è„šæœ¬è¯»å– JSON ä¸­çš„ `image_prompt`ï¼Œè°ƒç”¨æœ¬åœ° Stable Diffusion APIã€‚
    *   ä¿å­˜æ–‡ä»¶åæ ¼å¼: `{username}.png`
    *   ä¸Šä¼ è‡³ R2/S3ï¼Œè·å– `avatar_url`ã€‚
3.  **æ•°æ®å›å¡«**: å°† `avatar_url` å›å¡«å…¥ JSONã€‚
4.  **æ‰§è¡Œå¯¼å…¥**: è¿è¡Œ Convex Mutation å¯¼å…¥å®Œæ•´æ•°æ®ã€‚

```bash
# ç¤ºä¾‹ï¼šé€šè¿‡ Convex Dashboard æˆ– CLI è°ƒç”¨
npx convex run batch:importCharacters --file ./data/ready_to_import.json
```
